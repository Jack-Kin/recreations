This is an beautiful application of KMP algorithm.
